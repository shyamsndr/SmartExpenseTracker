{% extends 'base.html' %}

{% block title %}Expenzo{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="card p-4">

        <div class="mb-3">
            <h1 class="h3 d-inline align-middle">Add Transaction</h1>
        </div>
        
        <!-- Buttons for Expense & Income -->
        <div class="card-body">
            <button class="btn btn-outline-danger" id="expense-btn" onclick="selectType('expense')">Expense</button>
            <button class="btn btn-outline-success" id="income-btn" onclick="selectType('income')">Income</button>
            <input type="hidden" id="transaction-type" required>
        </div>

        <!-- Amount Input Field -->
        <div class="card-body">
            <input type="number" class="form-control" placeholder="Enter Amount" id="amount" required>
        </div>

        <!-- Category Dropdown -->
        <div class="card-body">
            <select class="form-select" id="category" required>
                <option value="" selected>Select Category</option>
                <option>Food</option>
                <option>Shopping</option>
                <option>Travel</option>
                <option>Other</option>
            </select>
        </div>

        <!-- Description Field -->
        <div class="card-body">
            <textarea class="form-control" rows="2" placeholder="Enter Description" id="description"></textarea>
        </div>

        <!-- Date & Time Fields -->
        <div class="card-body">
            <label for="date">Date</label>
            <input type="date" class="form-control" id="date">
        </div>

        <div class="card-body">
            <label for="time">Time</label>
            <input type="time" class="form-control" id="time">
        </div>

        <!-- Submit Button -->
        <div class="card-body">
            <button class="btn btn-primary" onclick="submitTransaction()">Submit</button>
        </div>
    </div>
</div>

<script>
    function selectType(type) {
        let expenseBtn = document.getElementById("expense-btn");
        let incomeBtn = document.getElementById("income-btn");
        let transactionType = document.getElementById("transaction-type");

        if (type === "expense") {
            expenseBtn.classList.add("btn-danger", "border-2");
            expenseBtn.classList.remove("btn-outline-danger");
            incomeBtn.classList.remove("btn-success", "border-2");
            incomeBtn.classList.add("btn-outline-success");
        } else {
            incomeBtn.classList.add("btn-success", "border-2");
            incomeBtn.classList.remove("btn-outline-success");
            expenseBtn.classList.remove("btn-danger", "border-2");
            expenseBtn.classList.add("btn-outline-danger");
        }

        transactionType.value = type;
    }

    function submitTransaction() {
        let type = document.getElementById("transaction-type").value;
        let amount = document.getElementById("amount").value;
        let category = document.getElementById("category").value;
        let date = document.getElementById("date").value;
        let time = document.getElementById("time").value;

        if (!type || !amount || !category) {
            alert("Please select Income or Expense, enter Amount, and choose a Category.");
            return;
        }
        
        if (!date || !time) {
            let now = new Date();
            document.getElementById("date").value = now.toISOString().split("T")[0];
            document.getElementById("time").value = now.toTimeString().slice(0, 5);
        }
        
        alert("Transaction submitted successfully!");
    }
</script>
{% endblock %}